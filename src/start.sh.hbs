#! {{shell}}

tmux start-server;

cd {{root}}

tmux new-session -d -s {{name}}

# TODO Support a non-root start location
# Setup the windows
{{#each windows}}
    {{#if @first}}
    tmux rename-window -t {{@root.name}}:0 {{name}}
    {{else}}
    tmux new-window -t {{@root.name}}:{{@index}} -n {{name}} -c {{@root.root}}
    {{/if}}

    # Run each of the configured commands for the window
    {{#each commands}}
        tmux send-keys -t {{@root.name}}:{{@../index}} '{{{this}}}' C-m
    {{/each}}
{{/each}}

